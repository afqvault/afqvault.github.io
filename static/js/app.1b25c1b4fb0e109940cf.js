webpackJsonp([1],{"+R46":function(t,e){},"9M+g":function(t,e){},Jmt5:function(t,e){},NHnr:function(t,e,a){"use strict";function n(t,e,a,n){var s="[?&]"+e+"=([^&#]*)",i=new RegExp(s),o=i.exec(t);return null!=o&&(a.close(),n(o[1])),""}function s(t,e){var a=v.authUrl+"/"+t;h.a.get(a,{headers:{crossDomain:!0}}).then(function(t){m.a.set("token",t.data.token),e(t.data.token,null)}).catch(function(t){e(null,t),m.a.clearAll()})}function i(t,e,a){var i=window.open(t,"windowname1","width=800, height=600"),o=window.setInterval(function(){try{if(-1!==i.document.URL.indexOf(e)){window.clearInterval(o);n(i.document.URL,"code",i,function(t){s(t,a)})}}catch(t){}},100)}function o(t){a("fqxp")}function r(t){a("sMpb")}function c(t){a("Og1M")}function u(t){a("+R46")}Object.defineProperty(e,"__esModule",{value:!0});var l=a("7+uW"),d=a("sCSS"),f=(a("Jmt5"),a("9M+g"),a("TPi/"),a("mtWM")),h=a.n(f),p=a("Y4FN"),m=a.n(p),v={authUrl:"http://ec2-54-218-51-130.us-west-2.compute.amazonaws.com/api/authenticate/github",clientId:"2f0bef2b6cc228ff321b",redirectUri:"data.afqvault.org/",tables:["projects","subjects"],url:"http://ec2-54-218-51-130.us-west-2.compute.amazonaws.com/api/v1/",delete_url:"http://ec2-54-218-51-130.us-west-2.compute.amazonaws.com/api/delete_project/",projects:{sha:{type:"string"},url:{type:"string"},scan_parameters:{type:"dict"},delete:{type:"button",action:"delete"}},subjects:{subjectID:{type:"string"},sessionID:{type:"string"},metadata:{type:"dict"},nodes:{type:"list-dict"},project_id:{type:"objectid",relation:"projects"}}};window.axios=h.a,window.store=m.a;var _={login:function(t){i("https://github.com/login/oauth/authorize?client_id="+v.clientId,v.redirectUri,t)},logout:function(){m.a.clearAll()},getToken:function(){return m.a.get("token")}};l.a.use(d.a);var g={name:"app",data:function(){return{isAuthenticated:!1,tables:v.tables,userInfo:{username:null,isAdmin:!1}}},computed:{get_variant:function(){return this.userInfo.isAdmin?"dark":"info"}},methods:{authenticate:function(){var t=this;_.login(function(){t.getUserInfo()})},getMembershipInfo:function(){var t=this,e="https://api.github.com/orgs/afqvault/members/"+this.userInfo.username,a=_.getToken();console.log(e),h.a.get(e,{headers:{Authorization:"token "+a}}).then(function(e){204===e.status&&(t.userInfo.isAdmin=!0)}).catch(function(t){console.log("error",t)})},getUserInfo:function(){var t=_.getToken(),e=this;h.a.get("https://api.github.com/user",{headers:{Authorization:"token "+t}}).then(function(t){e.isAuthenticated=!0,e.userInfo.username=t.data.login,e.userInfo.avatar=t.data.avatar_url}).catch(function(){e.logout()}).then(function(){e.getMembershipInfo()})},logout:function(){this.isAuthenticated=!1,this.userInfo.username=null,this.userInfo.isAdmin=!1,_.logout()}},created:function(){this.getUserInfo()}},b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("b-navbar",{attrs:{toggleable:"md",type:"dark",variant:t.get_variant}},[a("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),t._v(" "),a("b-navbar-brand",{attrs:{href:"#"}},[t._v("AFQ-Vault")]),t._v(" "),a("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[a("b-navbar-nav",[a("b-nav-item",{attrs:{to:"/",exact:""}},[t._v("Home")]),t._v(" "),t._l(t.tables,function(e){return a("span",[a("b-nav-item",{attrs:{to:"/tables/"+e}},[t._v("\n            "+t._s(e)+"\n          ")])],1)})],2),t._v(" "),a("b-navbar-nav",{staticClass:"ml-auto"},[t.isAuthenticated?a("b-nav-item-dropdown",{attrs:{right:""}},[a("template",{slot:"button-content"},[a("em",[t._v(t._s(t.userInfo.username))])]),t._v(" "),a("b-dropdown-item",{attrs:{to:"/profile"}},[t._v("Profile")]),t._v(" "),a("b-dropdown-item",{on:{click:t.logout}},[t._v("Signout")])],2):a("b-nav-item",[a("a",{on:{click:function(e){t.authenticate()}}},[t._v("Admin Login")])])],1)],1)],1),t._v(" "),a("div",{staticClass:"router"},[a("router-view",{attrs:{isAuthenticated:t.isAuthenticated,userInfo:t.userInfo}})],1)],1)},w=[],A={render:b,staticRenderFns:w},y=A,k=a("VU/8"),I=o,x=k(g,y,!1,I,null,null),C=x.exports,j=a("/ocq"),F={name:"Home",data:function(){return{msg:"Welcome to your Vue app boilerplate"}}},U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"jumbotron"},[a("div",{staticClass:"container"},[a("h1",{staticClass:"jumbotron-heading"},[t._v("AFQ Vault")]),t._v(" "),a("p",{staticClass:"lead text-muted text-center"},[t._v(" A vault for AFQ-Browser results\n        "),a("br"),a("br"),t._v(" "),a("b-button",{staticStyle:{color:"white"},attrs:{variant:"primary",to:"/tables/projects"}},[t._v(" View Projects ")])],1),t._v(" "),t._m(0)])])])])},D=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"desc"},[a("div",{staticClass:"row"},[a("p",[a("a",{attrs:{href:"https://github.com/yeatmanlab/AFQ"}},[t._v("AFQ")]),t._v(" (Automated Fiber Quantification) generates tract profiles of tissue properties for major fiber tracts in healthy and diseased brains.\n          ")])]),t._v(" "),a("div",{staticClass:"row"},[a("p",[a("a",{attrs:{href:"https://github.com/yeatmanlab/AFQ-Browser"}},[t._v("AFQ-Browser")]),t._v(" is a visualization tool for AFQ results, and results of other tractometry pipelines including "),a("a",{attrs:{href:"https://surfer.nmr.mgh.harvard.edu/fswiki/Tracula"}},[t._v("TRACULA")]),t._v(".\n          ")])]),t._v(" "),a("div",{staticClass:"row"},[a("p",[t._v("\n            This vault stores the AFQ data shared by researchers. Run "),a("span",{staticClass:"code"},[t._v("afq-browser publish")]),t._v(" to share your data on the vault.\n          ")])])])}],M={render:U,staticRenderFns:D},T=M,R=a("VU/8"),Q=r,$=R(F,T,!1,Q,"data-v-3e524fb2",null),z=$.exports,E={name:"profile",data:function(){return{}},props:["isAuthenticated","userInfo"]},V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"profile"}},[t.isAuthenticated?a("div",[a("h1",[t._v(t._s(t.userInfo.username))]),t._v(" "),a("p",[t._v("\n      You are logged in. Try logging out to see what happens to this page.\n    ")]),t._v(" "),t.userInfo.isAdmin?a("p"):t._e(),a("h2",[t._v(" You are ADMIN. You can delete stuff ")]),t._v(" "),a("p")]):a("div",[a("h1",[t._v("Error!")]),t._v(" "),a("p",[t._v("\n      Please log in to see your profile\n    ")])])])},P=[],q={render:V,staticRenderFns:P},H=q,L=a("VU/8"),S=c,N=L(E,H,!1,S,null,null),O=N.exports,Y=a("fZjL"),B=a.n(Y),J=a("mTx5"),W={name:"Tables",data:function(){return{data:null,meta:{total:1,page:1,max_results:1},links:null,schema:{},title:null,currentPage:null}},props:["userInfo","isAuthenticated"],computed:{get_fields:function(){for(var t=[],e=B()(this.schema),a=0;a<e.length;a+=1){var n=e[a];if("string"===this.schema[n].type||"button"===this.schema[n].type){var s={key:n,sortable:!0};t.push(s)}}return t.push({key:"show_details"}),t},get_dict_fields:function(){for(var t=[],e=B()(this.schema),a=0;a<e.length;a+=1){var n=e[a];if("dict"===this.schema[n].type){var s={key:n,sortable:!0};t.push(s)}}return t}},created:function(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData:function(t){var e=this,a=this.$route.params.id,n=this,s=J(v.url,a);s=t?s+"/?page="+t:s,h.a.get(s,{_:Math.random()}).then(function(t){t.data._items.forEach(function(t,e,a){a[e]._showDetails=!1}),n.data=t.data._items,n.meta=t.data._meta,n.links=t.data._links,n.schema=v[a],n.title=e.$route.params.id})},do_delete:function(t){var e=this;console.log("item to delete is",t),h.a.get(""+v.delete_url+t._id,{_:Math.random()}).then(function(t){console.log(t),e.fetchData()}).catch(function(t){console.log("error is",t)})}}},Z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"tables"}},[a("h1",[t._v(" "+t._s(t.title)+" ")]),t._v(" "),a("div",{staticClass:"container"},[a("div",{staticClass:"row"},[a("b-pagination",{attrs:{size:"md","total-rows":t.meta.total,"per-page":t.meta.max_results,align:"end"},on:{change:t.fetchData},model:{value:t.meta.page,callback:function(e){t.$set(t.meta,"page",e)},expression:"meta.page"}}),t._v(" "),a("b-table",{attrs:{striped:"",hover:"",items:t.data,fields:t.get_fields,responsive:"lg"},scopedSlots:t._u([{key:"show_details",fn:function(e){return[a("b-form-checkbox",{model:{value:e.item._showDetails,callback:function(a){t.$set(e.item,"_showDetails",a)},expression:"row.item._showDetails"}})]}},{key:"delete",fn:function(e){return[a("b-button",{attrs:{variant:"danger",disabled:!t.userInfo.isAdmin},on:{click:function(a){t.do_delete(e.item)}}},[t._v("x")])]}},{key:"url",fn:function(e){return[a("a",{attrs:{href:e.item.url}},[t._v(t._s(e.item.url))])]}},{key:"row-details",fn:function(e){return[a("b-card",t._l(t.get_dict_fields,function(n){return a("b-row",{staticClass:"mb-2"},[a("b-col",{staticClass:"text-sm-right",attrs:{sm:"3"}},[a("b",[t._v(t._s(n.key))])]),t._v(" "),a("b-col",[t._v(t._s(e.item[n.key]))])],1)}))]}}])})],1)])])},G=[],K={render:Z,staticRenderFns:G},X=K,tt=a("VU/8"),et=u,at=tt(W,X,!1,et,null,null),nt=at.exports;l.a.use(j.a);var st=new j.a({routes:[{path:"/",name:"Home",component:z},{path:"/profile",name:"Profile",component:O},{path:"/tables/:id",name:"Tables",component:nt}]});l.a.config.productionTip=!1,new l.a({el:"#app",router:st,template:"<App/>",components:{App:C}})},Og1M:function(t,e){},fqxp:function(t,e){},sMpb:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.1b25c1b4fb0e109940cf.js.map